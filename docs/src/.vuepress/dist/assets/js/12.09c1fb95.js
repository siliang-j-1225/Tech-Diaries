(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{365:function(e,t,a){"use strict";a.r(t);var s=a(42),o=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"how-to-create-release-a-pipeline-of-solidity-smart-contracts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-create-release-a-pipeline-of-solidity-smart-contracts"}},[e._v("#")]),e._v(" How to create release a pipeline of solidity smart contracts")]),e._v(" "),a("p",[a("em",[e._v("2019/05")])]),e._v(" "),a("p",[e._v("This is an example of how to create an Azure DevOps release pipeline to deploy solidity smart contracts to WestLake, and using the new contract information to update Azure resources.")]),e._v(" "),a("p",[e._v("One of the problems for creating a pipeline for smart contracts is, the address of the contracts get updated every time after migrating. Thus if you have cloud resources based on the address information, those resources will need to be updated too.")]),e._v(" "),a("p",[e._v("In this example, we use Truffle to compile and migrate smart contracts and tool "),a("code",[e._v("jq")]),e._v(" to analysis json.")]),e._v(" "),a("h2",{attrs:{id:"step-1-install-npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1-install-npm"}},[e._v("#")]),e._v(" Step 1 install npm")]),e._v(" "),a("p",[e._v("Using the built-in plugs of Azure DevOps Pipelines to install npm, or run the following bash command:")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("npm install")])])]),e._v(" "),a("h2",{attrs:{id:"step-2-install-jq"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2-install-jq"}},[e._v("#")]),e._v(" Step 2 install jq")]),e._v(" "),a("p",[e._v("Run the following bash command:")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("sudo apt install jq")])])]),e._v(" "),a("p",[a("em",[e._v("Find more about "),a("a",{attrs:{href:"https://stedolan.github.io/jq/",target:"_blank",rel:"noopener noreferrer"}},[e._v("jq, command-line JSON processor"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("h2",{attrs:{id:"step-3-compile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-3-compile"}},[e._v("#")]),e._v(" Step 3 compile")]),e._v(" "),a("p",[e._v("Compile smart contracts with Truffle.")]),e._v(" "),a("p",[e._v("Run the following bash command:")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("npx truffle version")]),a("br"),e._v(" "),a("code",[e._v("npx truffle compile")])])]),e._v(" "),a("p",[a("em",[e._v("Find more about "),a("a",{attrs:{href:"https://www.trufflesuite.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Truffle"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("h2",{attrs:{id:"step-4-migrate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-4-migrate"}},[e._v("#")]),e._v(" Step 4 migrate")]),e._v(" "),a("p",[e._v("Run the following bash command:")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("npx truffle migrate --reset --network westlake")])])]),e._v(" "),a("h2",{attrs:{id:"steps-5-update-azure-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#steps-5-update-azure-resources"}},[e._v("#")]),e._v(" Steps 5 update Azure resources")]),e._v(" "),a("p",[e._v("After compilation and migration, the contracts in format of json file will be updated. That's why we install "),a("code",[e._v("jq")]),e._v(" in step 3, thus we can analysis the json file and get the updated information (like address of contracts).")]),e._v(" "),a("p",[e._v("Bash code example of obtaining address:")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v('addr="$(jq \'.networks."NETWORK_ID".address\' ../build/contracts/CONTRACT_NAME.json)"')])])]),e._v(" "),a("p",[a("em",[e._v("Find the complete example of how to update Logic Apps with the above sample codes "),a("a",{attrs:{href:"https://github.com/siliang-jiao/Tech-Diaries/tree/master/examples/solidity-deploy",target:"_blank",rel:"noopener noreferrer"}},[e._v("update-logic-app.sh"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("p",[e._v("{% include issue-3.html %}")])])}),[],!1,null,null,null);t.default=o.exports}}]);